var TodoApp;(function(t){var o=function(){function o(){this.layoutView=new t.LayoutView,this.view().controller=this,this.view().on("keyup","#new-todo",this.addNewTodo)}return o.prototype.view=function(){return this.layoutView},o.prototype.addNewTodo=function(o){var e=this.view().newTodo.val();if(13==o.which&&""!=e){var n=new t.Todo(e);t.Todos.push(n),Core.mediator.publish("UpdateTodos")}},o}();t.Layout=o})(TodoApp||(TodoApp={}));var TodoApp;(function(t){var o=function(){function o(){this.todoListView=new t.TodoListView,Core.mediator.subscribe(this,"UpdateTodos",this.updateTodoList)}return o.prototype.view=function(){return this.todoListView},o.prototype.updateTodoList=function(){this.view().render()},o}();t.TodoController=o})(TodoApp||(TodoApp={}));var Core;(function(t){var o=function(){function t(){this.subscribers=[]}return t.prototype.subscribe=function(t,o,e){this.subscribers.push({context:t,event:o,callback:e})},t.prototype.unsubscribe=function(t){var o=this.subscribers;this.filterTargets({key:"context",value:t}).forEach(function(t){var e=o.indexOf(t);e>=0&&o.splice(e,1)})},t.prototype.publish=function(t){this.filterTargets({key:"event",value:t}).forEach(function(t){t.callback.call(t.context,arguments)})},t.prototype.filterTargets=function(t){return this.subscribers.filter(function(o){return o[t.key]==t.value})},t}();t.Mediator=o,t.mediator=new o})(Core||(Core={}));var Core;(function(){(function(){function t(){}return t})()})(Core||(Core={}));var Core;(function(t){var o=function(){function t(){this.controller=null}return t.prototype.element=function(){return null},t.prototype.render=function(){},t.prototype.on=function(t,o,e){$(o).on(t,$.proxy(e,this.controller))},t}();t.BindableView=o})(Core||(Core={})),$(function(){new TodoApp.Layout,new TodoApp.TodoController});var TodoApp;(function(t){var o=function(){function t(t){this.title="untitled",this.completed=!1,this.title=t}return t.prototype.toggle=function(){this.completed=!this.completed},t.prototype.attributes=function(){return{title:this.title,completed:this.completed}},t}();t.Todo=o,t.Todos=[]})(TodoApp||(TodoApp={}));var __extends=this.__extends||function(t,o){function e(){this.constructor=t}e.prototype=o.prototype,t.prototype=new e},TodoApp;(function(t){var o=function(t){function o(){t.apply(this,arguments),this.newTodo=$("#new-todo")}return __extends(o,t),o.prototype.element=function(){return $("#body")},o.prototype.render=function(){},o}(Core.BindableView);t.LayoutView=o})(TodoApp||(TodoApp={}));var TodoApp;(function(t){var o=function(){function o(){this.todos=t.Todos}return o.prototype.element=function(){return $("#todo-list")},o.prototype.render=function(){var t=this.element(),o=this.todos;t.html("");for(var n=0,i=o.length;i>n;n++)(function(){var i=o[n],r=new e;r.todo=i,r.render(),t.append(r.element())})()},o}();t.TodoListView=o;var e=function(){function t(){this.todo=null,this.todoElement=null}return t.prototype.element=function(){return this.todoElement},t.prototype.render=function(){var t=Template.Todo(this.todo.attributes());this.todoElement=$(t)},t}();t.TodoView=e})(TodoApp||(TodoApp={}));var Template;(function(t){t.Todo=function(t){var o=t.completed?"checked":"",e=t.title,n="";return n+='<div class="view">',n+='  <input class="toggle" type="checkbox" '+o+">",n+="  <label>"+e+"</label>",n+='  <button class="destroy"></button>',n+="</div>",n+='<input class="edit" value="'+e+'">'}})(Template||(Template={}));